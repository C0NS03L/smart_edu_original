<%= render 'shared/single_box' do %>
  <h1 class="break-words pb-4 text-center text-3xl font-bold">
    <%= render 'shared/logo_text' %> <span class="inline-block"></span>
  </h1>

  <!-- Display plan information -->
  <div class="mb-4 rounded-lg bg-blue-50 p-4">
    <h3 class="font-bold">Selected Plan: <%= params[:plan]&.capitalize || 'Unknown' %></h3>
    <p>
      <% if params[:plan] == 'free_trial' %>
        Free Trial - 30 days
      <% elsif params[:plan] == 'standard' %>
        Standard Plan - $500/month
      <% elsif params[:plan] == 'premium' %>
        Premium Plan - $800/month
      <% end %>
    </p>
  </div>

  <% if @principal.errors.any? %>
    <div class="alert alert-error mt-4">
      <ul>
        <% @principal.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>
  <%= form_with(
        model: @principal,
        url: create_principal_signup_path,
        id: 'principalForm',
        method: :post,
        class: 'form-control mt-4',
        html: {
          autocomplete: 'on',
          id: 'principal-form'
        }
      ) do |form| %>
    <h2 class="text-lg font-bold"><%= t('signup.principal.enter_information') %></h2>
    <%= form.text_field :name,
                        class: 'input input-bordered w-full mt-2',
                        placeholder: t('signup.name_placeholder'),
                        required: true,
                        autofocus: true,
                        id: 'principal-name-field' %>
    <div class="relative mt-2">
      <%= form.email_field :email_address,
                           class: 'input input-bordered w-full',
                           placeholder: t('signup.email_placeholder'),
                           autocomplete: 'username',
                           id: 'principal-email-field' %>
      <div id="principal-email-feedback" class="text-error mt-1 hidden text-sm">Please enter a valid email address</div>
    </div>
    <div class="relative mt-2">
      <%= form.password_field :password,
                              class: 'input input-bordered w-full',
                              placeholder: t('signup.password_placeholder'),
                              autocomplete: 'new-password',
                              id: 'principal-password-field' %>
      <div id="principal-password-feedback" class="text-error mt-1 hidden text-sm">
        Password must be at least 8 characters with letters and numbers
      </div>
    </div>
    <div class="relative mt-2">
      <%= form.password_field :password_confirmation,
                              class: 'input input-bordered w-full',
                              placeholder: t('signup.confirm_password_placeholder'),
                              autocomplete: 'new-password',
                              id: 'principal-password-confirmation-field' %>
      <div id="principal-password-match-feedback" class="text-error mt-1 hidden text-sm">Passwords do not match</div>
    </div>
    <div class="relative mt-2">
      <%= form.text_field :phone_number,
                          class: 'input input-bordered w-full',
                          placeholder: t('signup.principal.phone_placeholder'),
                          required: true,
                          id: 'principal-phone-field' %>
      <div id="principal-phone-feedback" class="text-error mt-1 hidden text-sm">Please enter a valid phone number</div>
    </div>

    <h2 class="mt-4 text-lg font-bold">Enter Your School Information</h2>
    <%= form.fields_for :school do |school_form| %>
      <%= school_form.text_field :name,
                                 class: 'input input-bordered w-full mt-2',
                                 placeholder: t('signup.principal.school_name_placeholder'),
                                 required: true,
                                 id: 'school-name-field' %>
      <%= school_form.text_field :address,
                                 class: 'input input-bordered w-full mt-2',
                                 placeholder: t('signup.principal.school_address_placeholder'),
                                 required: true,
                                 id: 'school-address-field' %>
      <%= school_form.text_field :country,
                                 class: 'input input-bordered w-full mt-2',
                                 placeholder: t('signup.principal.country_placeholder'),
                                 required: true,
                                 id: 'school-country-field' %>
    <% end %>
    <%= hidden_field_tag :plan, params[:plan] %>
    <%= hidden_field_tag :amount, params[:amount] %>
    <%= form.submit 'Subscribe', class: 'btn btn-primary w-full mt-2', id: 'subscribeButton' %>
  <% end %>
  <%= link_to t('signup.back_to_signin'), new_session_path, class: 'btn btn-ghost' %>
  <%= render 'shared/form_validation_scripts' %>
<% end %>
